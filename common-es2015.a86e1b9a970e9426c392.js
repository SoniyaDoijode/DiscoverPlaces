(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"2c9M":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return s}));const o={getEngine(){const e=window;return e.TapticEngine||e.Capacitor&&e.Capacitor.isPluginAvailable("Haptics")&&e.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(e){const t=this.getEngine();if(!t)return;const i=this.isCapacitor()?e.style.toUpperCase():e.style;t.impact({style:i})},notification(e){const t=this.getEngine();if(!t)return;const i=this.isCapacitor()?e.style.toUpperCase():e.style;t.notification({style:i})},selection(){this.impact({style:"light"})},selectionStart(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionStart():e.gestureSelectionStart())},selectionChanged(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionChanged():e.gestureSelectionChanged())},selectionEnd(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionEnd():e.gestureSelectionEnd())}},n=()=>{o.selection()},r=()=>{o.selectionStart()},a=()=>{o.selectionChanged()},s=()=>{o.selectionEnd()},c=e=>{o.impact(e)}},"6i10":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));const o={bubbles:{dur:1e3,circles:9,fn:(e,t,i)=>{const o=e*t/i-e+"ms",n=2*Math.PI*t/i;return{r:5,style:{top:9*Math.sin(n)+"px",left:9*Math.cos(n)+"px","animation-delay":o}}}},circles:{dur:1e3,circles:8,fn:(e,t,i)=>{const o=t/i,n=e*o-e+"ms",r=2*Math.PI*o;return{r:5,style:{top:9*Math.sin(r)+"px",left:9*Math.cos(r)+"px","animation-delay":n}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(e,t)=>({r:6,style:{left:9-9*t+"px","animation-delay":-110*t+"ms"}})},lines:{dur:1e3,lines:12,fn:(e,t,i)=>({y1:17,y2:29,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/i-e+"ms"}})},"lines-small":{dur:1e3,lines:12,fn:(e,t,i)=>({y1:12,y2:20,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/i-e+"ms"}})}}},NqGI:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return n}));const o=async(e,t,i,o,n)=>{if(e)return e.attachViewToDom(t,i,n,o);if("string"!=typeof i&&!(i instanceof HTMLElement))throw new Error("framework delegate is missing");const r="string"==typeof i?t.ownerDocument&&t.ownerDocument.createElement(i):i;return o&&o.forEach(e=>r.classList.add(e)),n&&Object.assign(r,n),t.appendChild(r),r.componentOnReady&&await r.componentOnReady(),r},n=(e,t)=>{if(t){if(e)return e.removeViewFromDom(t.parentElement,t);t.remove()}return Promise.resolve()}},Qe3P:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var o=i("2Vo4"),n=i("LRne");class r{constructor(e,t,i,o,n,r,a,s,c){this.id=e,this.title=t,this.description=i,this.imageUrl=o,this.price=n,this.availableFrom=r,this.availableTo=a,this.userId=s,this.location=c}}var a=i("lJxs"),s=i("vkgz"),c=i("IzEk"),l=i("eIep"),b=i("fXoL"),u=i("qXBG"),d=i("tk/3");let m=(()=>{class e{constructor(e,t){this.authService=e,this.http=t,this._places=new o.a([])}get places(){return this._places.asObservable()}fetchPlaces(){return this.http.get("https://ionic-angular-app-fc39f.firebaseio.com/offered-places.json").pipe(Object(a.a)(e=>{const t=[];for(const i in e)console.log(i,"key"),e.hasOwnProperty(i)&&(t.push(new r(i,e[i].title,e[i].description,e[i].imageUrl,e[i].price,new Date(e[i].availableFrom),new Date(e[i].availableTo),e[i].userId,e[i].location)),console.log(t));return t}),Object(s.a)(e=>{this._places.next(e)}))}getPlace(e){return this.http.get(`https://ionic-angular-app-fc39f.firebaseio.com/offered-places/${e}.json`).pipe(Object(a.a)(t=>(console.log(t),new r(e,t.title,t.description,t.imageUrl,t.price,new Date(t.availableFrom),new Date(t.availableFrom),t.userId,t.location))))}addPlace(e,t,i,o,n,a){let b,u;return this.authService.userId.pipe(Object(c.a)(1),Object(l.a)(s=>{if(!s)throw new Error("No user Found");return u=new r(Math.random().toString(),e,t,"https://upload.wikimedia.org/wikipedia/commons/4/47/New_york_times_square-terabass.jpg",i,o,n,s,a),this.http.post("https://ionic-angular-app-fc39f.firebaseio.com/offered-places.json",Object.assign(Object.assign({},u),{id:null}))})).pipe(Object(l.a)(e=>(b=e.name,this.places)),Object(c.a)(1),Object(s.a)(e=>{u.id=b,this._places.next(e.concat(u))}))}updatePlace(e,t,i){let o;return this.places.pipe(Object(c.a)(1),Object(l.a)(e=>!e||e.length<=0?this.fetchPlaces():Object(n.a)(e)),Object(l.a)(n=>{const a=n.findIndex(t=>t.id==e);o=[...n];const s=o[a];return o[a]=new r(s.id,t,i,s.imageUrl,s.price,s.availableFrom,s.availableTo,s.userId,s.location),this.http.put(`https://ionic-angular-app-fc39f.firebaseio.com/offered-places/${e}.json`,Object.assign(Object.assign({},o[a]),{id:null}))}),Object(s.a)(()=>{this._places.next(o)}))}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(u.a),b.Ob(d.a))},e.\u0275prov=b.Db({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"U/uv":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var o=i("sxy2"),n=i("ItpF"),r=i("2c9M");const a=(e,t)=>{let i,a;const s=(e,o,n)=>{if("undefined"==typeof document)return;const r=document.elementFromPoint(e,o);r&&t(r)?r!==i&&(l(),c(r,n)):l()},c=(e,t)=>{i=e,a||(a=i);const n=i;Object(o.g)(()=>n.classList.add("ion-activated")),t()},l=(e=!1)=>{if(!i)return;const t=i;Object(o.g)(()=>t.classList.remove("ion-activated")),e&&a!==i&&i.click(),i=void 0};return Object(n.createGesture)({el:e,gestureName:"buttonActiveDrag",threshold:0,onStart:e=>s(e.currentX,e.currentY,r.a),onMove:e=>s(e.currentX,e.currentY,r.b),onEnd:()=>{l(!0),Object(r.e)(),a=void 0}})}},VFTF:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var o=i("2Vo4"),n=i("IzEk"),r=i("eIep"),a=i("vkgz"),s=i("lJxs");class c{constructor(e,t,i,o,n,r,a,s,c,l){this.id=e,this.placeId=t,this.userId=i,this.placeTitle=o,this.placeImage=n,this.firstName=r,this.lastName=a,this.guestNumber=s,this.bookedFrom=c,this.bookedTo=l}}var l=i("fXoL"),b=i("qXBG"),u=i("tk/3");let d=(()=>{class e{constructor(e,t){this.authService=e,this.http=t,this._bookings=new o.a([])}get bookings(){return this._bookings.asObservable()}addBooking(e,t,i,o,s,l,b,u){let d,m;return this.authService.userId.pipe(Object(n.a)(1),Object(r.a)(n=>{if(!n)throw new Error("No userid found");return m=new c(Math.random().toString(),e,n,t,i,o,s,l,b,u),this.http.post("https://ionic-angular-app-fc39f.firebaseio.com/bookings.json",Object.assign(Object.assign({},m),{id:null}))}),Object(r.a)(e=>(d=e.name,this.bookings)),Object(n.a)(1),Object(a.a)(e=>{m.id=d,this._bookings.next(e.concat(m))}))}cancelBooking(e){return this.http.delete(`https://ionic-angular-app-fc39f.firebaseio.com/bookings/${e}.json`).pipe(Object(r.a)(()=>this.bookings),Object(n.a)(1),Object(a.a)(t=>{this._bookings.next(t.filter(t=>t.id!==e))}))}fetchBookings(){return this.authService.userId.pipe(Object(n.a)(1),Object(r.a)(e=>{if(!e)throw new Error("No user found");return this.http.get(`https://ionic-angular-app-fc39f.firebaseio.com/bookings.json?orderBy="userId"&equalTo="${e}"`)}),Object(s.a)(e=>{const t=[];for(const i in e)e.hasOwnProperty(i)&&t.push(new c(i,e[i].placeId,e[i].userId,e[i].placeTitle,e[i].placeImage,e[i].firstName,e[i].lastName,e[i].guestNumber,new Date(e[i].bookedFrom),new Date(e[i].bookedTo)));return t}),Object(a.a)(e=>{this._bookings.next(e)}))}}return e.\u0275fac=function(t){return new(t||e)(l.Ob(b.a),l.Ob(u.a))},e.\u0275prov=l.Db({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},g1t5:function(e,t,i){"use strict";i.r(t),i.d(t,"PlaceDetailPageModule",(function(){return w}));var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),a=i("tyNb"),s=i("IzEk"),c=i("eIep"),l=i("fXoL");const b=["f"];let u=(()=>{class e{constructor(e){this.modalCtrl=e}ngOnInit(){const e=new Date(this.selectedPlace.availableFrom),t=new Date(this.selectedPlace.availableTo);"random"===this.selectedMode&&(this.startDate=new Date(e.getTime()+Math.random()*(t.getTime()-6048e5-e.getTime())).toISOString(),this.endDate=new Date(new Date(this.startDate).getTime()+Math.random()*(new Date(this.startDate).getTime()+5184e5-new Date(this.startDate).getTime())).toISOString())}onCancel(){this.modalCtrl.dismiss(null,"cancel")}onBookPlace(){this.form.valid&&this.datesValid&&this.modalCtrl.dismiss({bookingData:{firstName:this.form.value["first-name"],lastName:this.form.value["last-name"],guestNumber:+this.form.value["guest-number"],startDate:new Date(this.form.value["date-from"]),endDate:new Date(this.form.value["date-to"])}},"confirm")}datesValid(){const e=new Date(this.form.value["date-from"]);return new Date(this.form.value["date-to"])>e}}return e.\u0275fac=function(t){return new(t||e)(l.Hb(r.X))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-create-booking"]],viewQuery:function(e,t){var i;1&e&&l.gc(b,!0),2&e&&l.bc(i=l.Tb())&&(t.form=i.first)},inputs:{selectedPlace:"selectedPlace",selectedMode:"selectedMode"},decls:51,vars:9,consts:[["slot","primary",3,"click"],["name","close"],[1,"ion-text-center","padding"],[3,"ngSubmit"],["f","ngForm"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","ngModel","","name","first-name","required",""],["type","text","ngModel","","name","last-name","required",""],["name","guest-number",3,"ngModel"],["value","1"],["value","2"],["value","3"],["size-sm","3","offset-sm","3"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-from","required","",3,"min","max","ngModel"],["startDateCtrl","ngModel"],["size-sm","3"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-to","required","",3,"min","max","ngModel"],["color","primary","type","submit","expand","block",3,"disabled"]],template:function(e,t){if(1&e&&(l.Kb(0,"ion-header"),l.Kb(1,"ion-toolbar"),l.Kb(2,"ion-title"),l.ic(3),l.Jb(),l.Kb(4,"ion-buttons",0),l.Sb("click",(function(){return t.onCancel()})),l.Kb(5,"ion-button"),l.Ib(6,"ion-icon",1),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Kb(7,"ion-content",2),l.Kb(8,"form",3,4),l.Sb("ngSubmit",(function(){return t.onBookPlace()})),l.Kb(10,"ion-grid"),l.Kb(11,"ion-row"),l.Kb(12,"ion-col",5),l.Kb(13,"ion-item"),l.Kb(14,"ion-label",6),l.ic(15," First Name "),l.Jb(),l.Ib(16,"ion-input",7),l.Jb(),l.Jb(),l.Jb(),l.Kb(17,"ion-row"),l.Kb(18,"ion-col",5),l.Kb(19,"ion-item"),l.Kb(20,"ion-label",6),l.ic(21," Last Name "),l.Jb(),l.Ib(22,"ion-input",8),l.Jb(),l.Jb(),l.Jb(),l.Kb(23,"ion-row"),l.Kb(24,"ion-col",5),l.Kb(25,"ion-item"),l.Kb(26,"ion-label",6),l.ic(27," Number of guests "),l.Jb(),l.Kb(28,"ion-select",9),l.Kb(29,"ion-select-option",10),l.ic(30," 1 "),l.Jb(),l.Kb(31,"ion-select-option",11),l.ic(32," 2 "),l.Jb(),l.Kb(33,"ion-select-option",12),l.ic(34," 3 "),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Kb(35,"ion-row"),l.Kb(36,"ion-col",13),l.Kb(37,"ion-item"),l.Kb(38,"ion-label",6),l.ic(39," From "),l.Jb(),l.Ib(40,"ion-datetime",14,15),l.Jb(),l.Jb(),l.Kb(42,"ion-col",16),l.Kb(43,"ion-item"),l.Kb(44,"ion-label",6),l.ic(45," To "),l.Jb(),l.Ib(46,"ion-datetime",17),l.Jb(),l.Jb(),l.Jb(),l.Kb(47,"ion-row"),l.Kb(48,"ion-col",13),l.Kb(49,"ion-button",18),l.ic(50,"Book!"),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb()),2&e){const e=l.cc(9),i=l.cc(41);l.xb(3),l.jc(t.selectedPlace.title),l.xb(25),l.Zb("ngModel","2"),l.xb(12),l.Zb("min",t.selectedPlace.availableFrom.toISOString())("max",t.selectedPlace.availableTo.toISOString())("ngModel",t.startDate),l.xb(6),l.Zb("min",i.value)("max",t.selectedPlace.availableTo.toISOString())("ngModel",t.endDate),l.xb(3),l.Zb("disabled",!e.valid||!t.datesValid())}},directives:[r.r,r.R,r.Q,r.h,r.g,r.s,r.o,n.q,n.k,n.l,r.q,r.F,r.n,r.v,r.z,r.u,r.db,n.j,n.m,n.o,r.I,r.cb,r.J,r.p],styles:[""]}),e})();var d=i("Qe3P"),m=i("VFTF"),p=i("qXBG");function f(e,t){if(1&e){const e=l.Lb();l.Kb(0,"ion-row"),l.Kb(1,"ion-col",9),l.Kb(2,"ion-button",10),l.Sb("click",(function(){return l.dc(e),l.Ub(2).onBookPlace()})),l.ic(3," Book "),l.Jb(),l.Jb(),l.Jb()}}function h(e,t){if(1&e&&(l.Kb(0,"ion-grid",4),l.Kb(1,"ion-row"),l.Kb(2,"ion-col",5),l.Ib(3,"ion-img",6),l.Jb(),l.Jb(),l.Kb(4,"ion-row"),l.Kb(5,"ion-col",7),l.Kb(6,"p"),l.ic(7),l.Jb(),l.Jb(),l.Jb(),l.hc(8,f,4,0,"ion-row",8),l.Jb()),2&e){const e=l.Ub();l.xb(3),l.Zb("src",e.place.imageUrl),l.xb(4),l.jc(e.place.description),l.xb(1),l.Zb("ngIf",e.isBookable)}}const g=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,r,a,s,c,l){this.activatedRoute=e,this.navCtrl=t,this.modalCtrl=i,this.placesService=o,this.actionSheetCtrl=n,this.bookingService=r,this.loadingCtrl=a,this.authService=s,this.alertCtrl=c,this.router=l}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{if(!e.has("placeId"))return void this.navCtrl.navigateBack("/places/tabs/discover");let t;this.isLoading=!0,this.authService.userId.pipe(Object(s.a)(1),Object(c.a)(i=>{if(!i)throw new Error("Found no user!");return this.loadingCtrl.create({message:"Loading..."}).then(e=>{e.present(),e.dismiss()}),t=i,this.placesService.getPlace(e.get("placeId"))})).subscribe(e=>{this.place=e,this.isBookable=e.userId!==t,this.isLoading=!1},e=>{this.isLoading=!1,this.alertCtrl.create({header:"An error occured",message:"Could not load place!",buttons:[{text:"okay",handler:()=>{this.router.navigate(["/places/tabs/discover"])}}]}).then(e=>{e.present()})})})}onBookPlace(){this.actionSheetCtrl.create({header:"Choose an action",buttons:[{text:"Select Date",handler:()=>{this.openBookingModal("select")}},{text:" Random date",handler:()=>{this.openBookingModal("random")}},{text:"Cancel",role:"destructive"}]}).then(e=>{e.present()})}openBookingModal(e){console.log(e),this.modalCtrl.create({component:u,componentProps:{selectedPlace:this.place,selectedMode:e}}).then(e=>(e.present(),e.onDidDismiss())).then(e=>{console.log(e.data,e.role),"confirm"===e.role&&this.loadingCtrl.create({message:"Booking Place..."}).then(t=>{t.present();const i=e.data.bookingData;this.bookingService.addBooking(this.place.id,this.place.title,this.place.imageUrl,i.firstName,i.lastName,i.guestNumber,i.startDate,i.endDate).subscribe(()=>{t.dismiss()})})})}ngOnDestroy(){this.placeSub&&this.placeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(l.Hb(a.a),l.Hb(r.Y),l.Hb(r.X),l.Hb(d.a),l.Hb(r.a),l.Hb(m.a),l.Hb(r.V),l.Hb(p.a),l.Hb(r.b),l.Hb(a.g))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-place-detail"]],decls:8,vars:2,consts:[["color","primary"],["slot","start"],["defaultHref","/places/tabs/discover"],["class","ion-no-padding",4,"ngIf"],[1,"ion-no-padding"],["size-sm","6","offset-sm","3"],[3,"src"],["size-sm","6","offset-sm","3",1,"ion-text-center","ion-padding"],[4,"ngIf"],["size-sm","6","offset-sm","3",1,"ion-text-center"],["color","primary",1,"ion-margin",3,"click"]],template:function(e,t){1&e&&(l.Kb(0,"ion-header"),l.Kb(1,"ion-toolbar",0),l.Kb(2,"ion-buttons",1),l.Ib(3,"ion-back-button",2),l.Jb(),l.Kb(4,"ion-title"),l.ic(5),l.Jb(),l.Jb(),l.Jb(),l.Kb(6,"ion-content"),l.hc(7,h,9,3,"ion-grid",3),l.Jb()),2&e&&(l.xb(5),l.jc(t.isLoading?"Loading...":t.place.title),l.xb(2),l.Zb("ngIf",!t.isLoading))},directives:[r.r,r.R,r.h,r.e,r.f,r.Q,r.o,o.k,r.q,r.F,r.n,r.t,r.g],styles:[".location-image[_ngcontent-%COMP%]{width:100%;height:25rem;max-height:30vh;-o-object-fit:cover;object-fit:cover}p[_ngcontent-%COMP%]{margin:0}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(g)],a.i]}),e})(),w=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(t){return new(t||e)},imports:[[o.b,n.f,r.T,v]]}),e})()},sPtc:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return s}));const o=(e,t)=>null!==t.closest(e),n=(e,t)=>"string"==typeof e&&e.length>0?Object.assign({"ion-color":!0,["ion-color-"+e]:!0},t):t,r=e=>{const t={};return(e=>void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter(e=>null!=e).map(e=>e.trim()).filter(e=>""!==e):[])(e).forEach(e=>t[e]=!0),t},a=/^[a-z][a-z0-9+\-.]*:/,s=async(e,t,i,o)=>{if(null!=e&&"#"!==e[0]&&!a.test(e)){const n=document.querySelector("ion-router");if(n)return null!=t&&t.preventDefault(),n.push(e,i,o)}return!1}},"vm+t":function(e,t,i){"use strict";i.r(t),i.d(t,"EditOfferPageModule",(function(){return m}));var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),a=i("tyNb"),s=i("fXoL"),c=i("Qe3P");function l(e,t){1&e&&(s.Kb(0,"ion-row"),s.Kb(1,"ion-col",9),s.Kb(2,"p"),s.ic(3,"Description must be between 1 and 180 characters."),s.Jb(),s.Jb(),s.Jb())}function b(e,t){if(1&e&&(s.Kb(0,"form",8),s.Kb(1,"ion-grid"),s.Kb(2,"ion-row"),s.Kb(3,"ion-col",9),s.Kb(4,"ion-item"),s.Kb(5,"ion-label",10),s.ic(6," Title "),s.Jb(),s.Ib(7,"ion-input",11),s.Jb(),s.Jb(),s.Jb(),s.Kb(8,"ion-row"),s.Kb(9,"ion-col",9),s.Kb(10,"ion-item"),s.Kb(11,"ion-label",10),s.ic(12," Short Description "),s.Jb(),s.Ib(13,"ion-textarea",12),s.Jb(),s.Jb(),s.Jb(),s.hc(14,l,4,0,"ion-row",13),s.Jb(),s.Jb()),2&e){const e=s.Ub();s.Zb("formGroup",e.form),s.xb(14),s.Zb("ngIf",!e.form.get("description").valid&&e.form.get("description").touched)}}const u=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,r){this.activatedRoute=e,this.navCtrl=t,this.placesService=i,this.router=o,this.loadingCtrl=n,this.alertCtrl=r}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{e.has("placeId")?(this.placeId=e.get("placeId"),this.isLoading=!0,this.loadingCtrl.create({message:"Loading..."}).then(t=>{t.present(),this.placeSub=this.placesService.getPlace(e.get("placeId")).subscribe(e=>{this.place=e,this.form=new n.d({title:new n.b(this.place.title,{updateOn:"blur",validators:[n.p.required]}),description:new n.b(this.place.description,{updateOn:"blur",validators:[n.p.required,n.p.maxLength(180)]})}),this.isLoading=!1,t.dismiss()},e=>{this.alertCtrl.create({header:"error occured",message:"Place could not be fetched. Please try again later...",buttons:[{text:"okay",handler:()=>{this.router.navigate(["/places/tabs/offers"])}}]}).then(e=>{t.dismiss(),e.present()})})})):this.navCtrl.navigateBack("/places/tabs/offers")})}onUpdateOffer(){this.form.valid&&this.loadingCtrl.create({message:"Updating Place...."}).then(e=>{e.present(),this.placesService.updatePlace(this.place.id,this.form.value.title,this.form.value.description).subscribe(()=>{e.dismiss(),this.form.reset(),this.router.navigate(["/places/tabs/offers"])})})}ngOnDestroy(){this.placeSub&&this.placeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Hb(a.a),s.Hb(r.Y),s.Hb(c.a),s.Hb(a.g),s.Hb(r.V),s.Hb(r.b))},e.\u0275cmp=s.Bb({type:e,selectors:[["app-edit-offer"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"defaultHref"],["slot","primary"],[3,"disabled","click"],["name","checkmark","slot","icon-only"],[1,"ion-padding"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","autocomplete","off","autocorrect","","formControlName","title"],["rows","3","formControlName","description"],[4,"ngIf"]],template:function(e,t){1&e&&(s.Kb(0,"ion-header"),s.Kb(1,"ion-toolbar",0),s.Kb(2,"ion-buttons",1),s.Ib(3,"ion-back-button",2),s.Jb(),s.Kb(4,"ion-title"),s.ic(5,"Edit Offer"),s.Jb(),s.Kb(6,"ion-buttons",3),s.Kb(7,"ion-button",4),s.Sb("click",(function(){return t.onUpdateOffer()})),s.Ib(8,"ion-icon",5),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Kb(9,"ion-content",6),s.hc(10,b,15,2,"form",7),s.Jb()),2&e&&(s.xb(3),s.Zb("defaultHref","/places/tabs/offers/"+t.placeId),s.xb(4),s.Zb("disabled",!(null!=t.form&&t.form.valid)),s.xb(3),s.Zb("ngIf",!t.isLoading))},directives:[r.r,r.R,r.h,r.e,r.f,r.Q,r.g,r.s,r.o,o.k,n.q,n.k,n.e,r.q,r.F,r.n,r.v,r.z,r.u,r.db,n.j,n.c,r.O],styles:[""]}),e})()}];let d=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(u)],a.i]}),e})(),m=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(t){return new(t||e)},imports:[[o.b,n.n,r.T,d]]}),e})()},wmmW:function(e,t,i){"use strict";i.r(t),i.d(t,"NewOfferPageModule",(function(){return w}));var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),a=i("tyNb"),s=i("fXoL"),c=i("Qe3P"),l=i("gcOT");const b=["filePicker"];function u(e,t){if(1&e){const e=s.Lb();s.Kb(0,"ion-img",4),s.Sb("click",(function(){return s.dc(e),s.Ub().onPickImage()})),s.Jb()}if(2&e){const e=s.Ub();s.Zb("src",e.selectedImage)}}function d(e,t){if(1&e){const e=s.Lb();s.Kb(0,"ion-button",5),s.Sb("click",(function(){return s.dc(e),s.Ub().onPickImage()})),s.Ib(1,"ion-icon",6),s.Kb(2,"ion-label"),s.ic(3,"Take picture"),s.Jb(),s.Jb()}}function m(e,t){if(1&e){const e=s.Lb();s.Kb(0,"input",7,8),s.Sb("change",(function(t){return s.dc(e),s.Ub().onFileChosen(t)})),s.Jb()}}let p=(()=>{class e{constructor(e){this.platform=e,this.imagePick=new s.n,this.showPreview=!1,this.usePicker=!1}ngOnInit(){console.log("Mobile",this.platform.is("mobile")),console.log("hybrid",this.platform.is("hybrid")),console.log("ios",this.platform.is("ios")),console.log("android",this.platform.is("android")),console.log("desktop",this.platform.is("desktop")),(this.platform.is("mobile")&&!this.platform.is("hybrid")||this.platform.is("desktop"))&&(this.usePicker=!0)}onPickImage(){l.c.isPluginAvailable("Camera")?l.d.Camera.getPhoto({quality:50,source:l.b.Prompt,correctOrientation:!0,height:320,width:200,resultType:l.a.DataUrl}).then(e=>{this.selectedImage=e.dataUrl,this.imagePick.emit(e.dataUrl)}).catch(e=>(console.log(e),this.usePicker&&this.filePickerRef.nativeElement.click(),!1)):this.filePickerRef.nativeElement.click()}onFileChosen(e){console.log(e);const t=e.target.files[0];if(!t)return;const i=new FileReader;i.onload=()=>{const e=i.result.toString();this.selectedImage=e,this.imagePick.emit(t)},i.readAsDataURL(t)}}return e.\u0275fac=function(t){return new(t||e)(s.Hb(r.ab))},e.\u0275cmp=s.Bb({type:e,selectors:[["app-image-picker"]],viewQuery:function(e,t){var i;1&e&&s.lc(b,!0),2&e&&s.bc(i=s.Tb())&&(t.filePickerRef=i.first)},inputs:{showPreview:"showPreview"},outputs:{imagePick:"imagePick"},decls:4,vars:3,consts:[[1,"picker"],["role","button","class","image",3,"src","click",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],["type","file","accept","image/jpeg",3,"change",4,"ngIf"],["role","button",1,"image",3,"src","click"],["color","primary",3,"click"],["name","camera","slot","start"],["type","file","accept","image/jpeg",3,"change"],["filePicker",""]],template:function(e,t){1&e&&(s.Kb(0,"div",0),s.hc(1,u,1,1,"ion-img",1),s.hc(2,d,4,0,"ion-button",2),s.Jb(),s.hc(3,m,2,0,"input",3)),2&e&&(s.xb(1),s.Zb("ngIf",t.selectedImage&&t.showPreview),s.xb(1),s.Zb("ngIf",!t.selectedImage||!t.showPreview),s.xb(1),s.Zb("ngIf",t.usePicker))},directives:[o.k,r.t,r.g,r.s,r.z],styles:[".picker[_ngcontent-%COMP%]{width:30rem;max-width:80%;height:20rem;max-height:30vh;border:1px solid var(--ion-color-primary);margin:auto;display:flex;justify-content:center;align-items:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}input[type=file][_ngcontent-%COMP%]{display:none}"]}),e})();function f(e,t){1&e&&(s.Kb(0,"ion-row"),s.Kb(1,"ion-col",7),s.Kb(2,"p"),s.ic(3,"Description must be between 1 and 180 characters."),s.Jb(),s.Jb(),s.Jb())}const h=[{path:"",component:(()=>{class e{constructor(e,t,i){this.placesService=e,this.router=t,this.loadingCtrl=i}ngOnInit(){this.form=new n.d({title:new n.b("",{updateOn:"blur",validators:[n.p.required]}),description:new n.b("",{updateOn:"blur",validators:[n.p.required,n.p.maxLength(180)]}),price:new n.b("",{updateOn:"blur",validators:[n.p.required,n.p.min(1)]}),dateFrom:new n.b("",{updateOn:"blur",validators:[n.p.required]}),dateTo:new n.b("",{updateOn:"blur",validators:[n.p.required]}),image:new n.b(null)})}onCreateOffer(){this.form.valid&&this.form.get("image").value&&(console.log(this.form.value),this.loadingCtrl.create({message:"Creating Place..."}).then(e=>{e.present(),this.placesService.addPlace(this.form.value.title,this.form.value.description,+this.form.value.price,new Date(this.form.value.dateFrom),new Date(this.form.value.dateTo),this.form.value.imageFile).subscribe(()=>{e.dismiss(),this.form.reset(),this.router.navigate(["/places/tabs/offers"])})}))}onLocationPicked(e){this.form.patchValue({location:e})}onImagePicked(e){let t;if("string"==typeof e)try{t=function(e,t){t=t||"";const i=window.atob(e),o=i.length,n=Math.ceil(o/1024),r=new Array(n);for(let a=0;a<n;++a){const e=1024*a,t=Math.min(e+1024,o),n=new Array(t-e);for(let o=e,r=0;o<t;++r,++o)n[r]=i[o].charCodeAt(0);r[a]=new Uint8Array(n)}return new Blob(r,{type:t})}(e.replace("data:image/jpeg;base64,",""),"image/jpeg")}catch(i){return void console.log(i)}else t=e;this.form.patchValue({image:t})}}return e.\u0275fac=function(t){return new(t||e)(s.Hb(c.a),s.Hb(a.g),s.Hb(r.V))},e.\u0275cmp=s.Bb({type:e,selectors:[["app-new-offer"]],decls:45,vars:4,consts:[["color","primary"],["slot","start"],["defaultHref","/places/tabs/offers"],["slot","primary"],[3,"disabled","click"],["name","checkmark","slot","icon-only"],[3,"formGroup"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","autocomplete","off","autocorrect","","formControlName","title"],["rows","3","formControlName","description"],[4,"ngIf"],["type","number","formControlName","price"],["size-sm","3","offset-sm","3"],["min","2019-01-01","max","2025-12-31","formControlName","dateFrom"],["size-sm","3"],["min","2019-01-02","max","2025-12-31","formControlName","dateTo"],[3,"showPreview","imagePick"]],template:function(e,t){1&e&&(s.Kb(0,"ion-header"),s.Kb(1,"ion-toolbar",0),s.Kb(2,"ion-buttons",1),s.Ib(3,"ion-back-button",2),s.Jb(),s.Kb(4,"ion-title"),s.ic(5,"New Offer"),s.Jb(),s.Kb(6,"ion-buttons",3),s.Kb(7,"ion-button",4),s.Sb("click",(function(){return t.onCreateOffer()})),s.Ib(8,"ion-icon",5),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Kb(9,"ion-content"),s.Kb(10,"form",6),s.Kb(11,"ion-grid"),s.Kb(12,"ion-row"),s.Kb(13,"ion-col",7),s.Kb(14,"ion-item"),s.Kb(15,"ion-label",8),s.ic(16," Title "),s.Jb(),s.Ib(17,"ion-input",9),s.Jb(),s.Jb(),s.Jb(),s.Kb(18,"ion-row"),s.Kb(19,"ion-col",7),s.Kb(20,"ion-item"),s.Kb(21,"ion-label",8),s.ic(22," Short Description "),s.Jb(),s.Ib(23,"ion-textarea",10),s.Jb(),s.Jb(),s.Jb(),s.hc(24,f,4,0,"ion-row",11),s.Kb(25,"ion-row"),s.Kb(26,"ion-col",7),s.Kb(27,"ion-item"),s.Kb(28,"ion-label",8),s.ic(29," Price "),s.Jb(),s.Ib(30,"ion-input",12),s.Jb(),s.Jb(),s.Jb(),s.Kb(31,"ion-row"),s.Kb(32,"ion-col",13),s.Kb(33,"ion-item"),s.Kb(34,"ion-label",8),s.ic(35," Available from "),s.Jb(),s.Ib(36,"ion-datetime",14),s.Jb(),s.Jb(),s.Kb(37,"ion-col",15),s.Kb(38,"ion-item"),s.Kb(39,"ion-label",8),s.ic(40," Available to "),s.Jb(),s.Ib(41,"ion-datetime",16),s.Jb(),s.Jb(),s.Jb(),s.Kb(42,"ion-row"),s.Kb(43,"ion-col",7),s.Kb(44,"app-image-picker",17),s.Sb("imagePick",(function(e){return t.onImagePicked(e)})),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb()),2&e&&(s.xb(7),s.Zb("disabled",!t.form.valid||!t.form.get("image").value),s.xb(3),s.Zb("formGroup",t.form),s.xb(14),s.Zb("ngIf",!t.form.get("description").valid&&t.form.get("description").touched),s.xb(20),s.Zb("showPreview",t.form.get("image").value))},directives:[r.r,r.R,r.h,r.e,r.f,r.Q,r.g,r.s,r.o,n.q,n.k,n.e,r.q,r.F,r.n,r.v,r.z,r.u,r.db,n.j,n.c,r.O,o.k,r.Z,r.p,r.cb,p],styles:[""]}),e})()}];let g=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(h)],a.i]}),e})(),v=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(t){return new(t||e)},imports:[[o.b,r.T]]}),e})(),w=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(t){return new(t||e)},imports:[[o.b,n.n,r.T,g,v]]}),e})()}}]);